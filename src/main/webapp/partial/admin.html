<div>
  <h1>Administration</h1>

  <p>
    Please be careful on this page; here, you have the power to change anything.
  </p>

  <h2>Admin Administration</h2>

  <form class="row collapse" name="addAdminForm" ng-submit="users.setAdmin(admin.name, true)">
    <div class="small-9 columns">
      <input type="text" ng-model="admin" required="required"
             placeholder="New administrator"
             typeahead="user as user.readableName + ' (' + user.name + ')' for user in find($viewValue) | limitTo:8"
             class="form-control"/>
    </div>
    <div class="small-3 columns">
      <button type="submit" ng-disabled="form.$invalid" class="button button-success postfix radius"
              style="margin-bottom: 0;">
        <i class="fi-plus white-icon size-16"></i>
        Add
      </button>
    </div>
  </form>
  <div class="row collapse">
    <div class="small-6 columns">
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Readable Name</th>
            <th>&nbsp;</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="admin in users.admins">
            <td>{{admin.name}}</td>
            <td>{{admin.readableName}}</td>
            <td>
              <button ng-if="users.admins.length > 1" ng-click="users.setAdmin(admin.name, false, users.current.name)" type="button" class="tiny alert"
                      style="margin-bottom: 0;">
                Remove
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <h2>Owner Administration</h2>
  Choose queue to administrate
  <select ng-model="dropdown" ng-change="selectQueue(queues.get(dropdown))">
    <option disabled="disabled" selected="selected" value="">Select Queue</option>
    <option ng-repeat="queue in ownedQueues">{{queue.name}}</option>
  </select>

  <form class="row collapse" name="addModeratorForm"
        ng-submit="queues.addOwner(selectedQueue.name, owner.name)">
    <div class="small-9 columns">
      <input type="text" ng-model="owner" required="required"
             placeholder="Add owner to selected queue"
             typeahead="user as user.readableName + ' (' + user.name + ')' for user in find($viewValue) | limitTo:8"
             class="form-control"/>
    </div>
    <div class="small-3 columns">
      <button type="submit" ng-disabled="form.$invalid" class="button button-success postfix radius"
              style="margin-bottom: 0;">
        <i class="fi-plus white-icon size-16"></i>
        Add
      </button>
    </div>
  </form>

  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Readable name</th>
        <th>&nbsp;</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="owner in selectedOwners">
        <td>{{owner.name}}</td>
        <td>{{owner.readableName}}</td>
        <td>
          <button ng-click="queues.removeOwner(selectedQueue.name, owner.name)"
                  type="button" class="tiny alert" style="margin-bottom: 0;">
            Remove
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <h2>Moderator Administration</h2>
  <select ng-model="dropdown" ng-change="selectQueue(queues.get(dropdown))">
    <option disabled="disabled" selected="selected" value="">Select Queue</option>
    <option ng-repeat="queue in ownedQueues">{{queue.name}}</option>
  </select>

  <form class="row collapse" name="addModeratorForm"
        ng-submit="queues.addModerator(selectedQueue.name, moderator.name)">
    <div class="small-9 columns">
      <input type="text" ng-model="moderator" required="required"
             placeholder="Add moderator to selected queue"
             typeahead="user as user.readableName + ' (' + user.name + ')' for user in find($viewValue) | limitTo:8"
             class="form-control"/>
    </div>
    <div class="small-3 columns">
      <button type="submit" ng-disabled="form.$invalid" class="button button-success postfix radius"
              style="margin-bottom: 0;">
        <i class="fi-plus white-icon size-16"></i>
        Add
      </button>
    </div>
  </form>

  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Readable name</th>
        <th>&nbsp;</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="moderator in selectedModerators">
        <td>{{moderator.name}}</td>
        <td>{{moderator.readableName}}</td>
        <td>
          <button ng-click="queues.removeModerator(selectedQueue.name, moderator.name)"
                  type="button" class="tiny alert" style="margin-bottom: 0;">
            Remove
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  <div ng-show="selectedQueue">
    <p>Selected queue: <strong>{{selectedQueue.title}}</strong></p>

    <form class="row collapse" name="addModeratorForm"
      ng-submit="queues.addModerator(selectedQueue.name, moderator.name)">
      <div class="small-9 columns">
        <input type="text" ng-model="moderator" required="required"
               placeholder="Add moderator to selected queue"
               typeahead="user as user.readableName + ' (' + user.name + ')' for user in find($viewValue) | limitTo:8"
               class="form-control"/>
      </div>
      <div class="small-3 columns">
        <button type="submit" ng-disabled="form.$invalid" class="button button-success postfix radius"
                style="margin-bottom: 0;">
          <i class="fi-plus white-icon size-16"></i>
          Add
        </button>
      </div>
    </form>
  </div>

  <div class="row">
    <div class="large-6 columns">
      <h3>Owned Queues</h3>

      <div ng-show="ownedQueues">
        <table>
          <thead>
            <tr>
              <th>Queue Name</th>
              <th>Queue Title</th>
              <th>&nbsp;</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="queue in ownedQueues">
              <td>{{queue.name}}</td>
              <td>{{queue.title}}</td>
              <td>
                <button ng-click="selectQueue(queue)" type="button" class="tiny"
                  style="margin-bottom: 0;">
                  Select
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div ng-hide="ownedQueues">
        <p>(No queues)</p>
      </div>
    </div>

    <div class="large-6 columns">
      <h3>Moderators</h3>

      <div ng-show="selectedQueue.moderators">
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Readable Name</th>
              <th>&nbsp;</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="user in selectedModerators">
              <td>{{user.name}}</td>
              <td>{{user.readableName}}</td>
              <td>
                <button ng-click="queues.removeModerator(selectedQueue.name, user.name)"
                  type="button" class="tiny alert" style="margin-bottom: 0;">
                  Remove
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div ng-hide="selectedQueue.moderators">
        <p>(No moderators)</p>
      </div>
    </div>
  </div>
</div>
